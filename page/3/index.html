<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="一个写代码的胖子">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="一个写代码的胖子">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="一个写代码的胖子">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>一个写代码的胖子</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">一个写代码的胖子</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archives"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/Animation视图动画/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/Animation视图动画/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>  　　 Animation框架定义了透明度、旋转、缩放和位移几种常见的动画，控制的是整个view，实现的原理是每次绘制视图时View所在的ViewGroup中的drawChild函数获取该View的Animation的Transformation值，调用canvas.concat(trabnsformToApply.getMatrix())，通过矩阵运算完成动画帧。如果没有完成，就继续调用invalidate的函数，启动下次绘制来驱动动画，从而完成整个动画的绘制。<br>　　 视图动画效率比较高且使用方便，但是有一个非常大的缺陷就是不具备交互性，当某个元素发生视图动画后，其相应事件的位置还依然在动画的前的地方，所以视图动画只能做普通的动画效果避免交互的发生。</p>
<p><img src="http://img.blog.csdn.net/20160503153711407" alt="这里写图片描述"></p>
<p>透明度动画：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AlphaAnimation aa = new AlphaAnimation(0.0f, 1.0f);//1.0表示完全不透明，0.0表示完全透明</span><br><span class="line">aa.setDuration(1000);//动画持续时间</span><br><span class="line">view.startAnimation(aa);</span><br></pre></td></tr></table></figure>
<p>旋转动画：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RotateAnimation ra = new RotateAnimation(0,360,100,100);//初始角度，旋转角度，旋转中心x坐标，旋转中心y坐标</span><br><span class="line">ra.setDuration(1000);</span><br><span class="line">view.startAnimation(ra);</span><br></pre></td></tr></table></figure>
<p>位移动画：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TranslateAnimation ta = new TranslateAnimation(0,200,0,300);//初始x坐标，位移后的x坐标，初始y坐标，位移后y坐标</span><br><span class="line">ta.setDuration(1000);</span><br><span class="line">view.startAnimation(ta);</span><br></pre></td></tr></table></figure>
<p>缩放动画：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ScaleAnimation  sa  = new ScaleAnimation(0.0f,2.0f,0.0f,2.0f);//开始时x坐标的伸缩尺寸，结束时x坐标上的伸缩尺寸，开始时y坐标的伸缩尺寸，结束时y坐标上的伸缩尺寸；0.0f表示收缩到没有，1.0f表示正常大小无缩放</span><br><span class="line">sa.setDuration(1000);</span><br><span class="line">view.startAnimation(sa);</span><br></pre></td></tr></table></figure>
<p>动画集合:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">AnimationSet as = new AnimationSet(true);</span><br><span class="line"></span><br><span class="line">AlphaAnimation aa = new AlphaAnimation(0,1);</span><br><span class="line">aa.setDuration(1000);</span><br><span class="line">as.addAnimation(aa);</span><br><span class="line">TranslateAnimation ta = new TranslateAnimation(0,200,0,300);</span><br><span class="line">ta.setDuration(1000);</span><br><span class="line">as.addAnimation(ta);</span><br><span class="line">RotateAnimation ra = new RotateAnimation(0,360,100,100);</span><br><span class="line">ra.setDuration(1000);</span><br><span class="line">as.addAnimation(ra);</span><br><span class="line"></span><br><span class="line">view.startAnimation(as);</span><br></pre></td></tr></table></figure>
<p> 常用方法 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">animation.setRepeatCount(int repeatCount);//设置重复次数</span><br><span class="line">animation.setFillAfter(boolean);//动画执行完后是否停留在执行完的状态</span><br><span class="line">animation.setStartOffset(long startOffset);//执行前的等待时间</span><br></pre></td></tr></table></figure>
<p>视图动画监听回调：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">animation.setAnimationListenter(new Animation.AnimationListener()&#123;</span><br><span class="line"> @Override</span><br><span class="line">            public void onAnimationStart(Animation animation) &#123;</span><br><span class="line">               //动画开始</span><br><span class="line">            &#125;</span><br><span class="line">            @Override</span><br><span class="line">            public void onAnimationEnd(Animation animation) &#123;</span><br><span class="line">               //动画结束</span><br><span class="line">            &#125;</span><br><span class="line">            @Override</span><br><span class="line">            public void onAnimationRepeat(Animation animation) &#123;</span><br><span class="line">             //动画重复</span><br><span class="line">            &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/android学习记录3(数据存储的方式sqlite、sp、存文件。listview简单使用)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/android学习记录3(数据存储的方式sqlite、sp、存文件。listview简单使用)/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#数据存储的方式</p>
<ol>
<li>存文件<blockquote>
<p>一般的数据</p>
</blockquote>
</li>
<li>sharedperference <blockquote>
<p>设置信息，配置信息，密码</p>
</blockquote>
</li>
<li>数据库<blockquote>
<p>相同的结构的数据，大量存储，增删改查。</p>
</blockquote>
</li>
</ol>
<p>##Sqlite</p>
<blockquote>
<p>开源的，嵌入式的数据库，轻量级。</p>
</blockquote>
<p>##数据库的创建</p>
<ol>
<li><p>文件的创建</p>
<pre><code>//引用，如果文件不存在是不会被创建
File file = new File(&quot;haha.txt&quot;);
//输出流写数据，文件才被创建
FileOutputStream fos = new FileOutputStream(file);
fos.write(&quot;&quot;.getBytes());
fos.close();
</code></pre></li>
<li><p>数据库的创建</p>
<pre><code> //执行下面的一行代码，数据库是不会别创建的了。
MyDBOpenHelper helper = new MyDBOpenHelper(this);
//如果想创建数据库必须执行,下一行代码
helper.getWritableDatabase();
</code></pre></li>
</ol>
<p>##数据库的操作</p>
<ul>
<li>增<blockquote>
<p>insert into info (name,phone) values (‘lisi’,’120’)</p>
</blockquote>
</li>
<li>删<blockquote>
<p> delete from info where _id = ‘2’</p>
</blockquote>
</li>
<li>改<blockquote>
<p>update info set phone=’999’ where name=’zhangsan’</p>
</blockquote>
</li>
<li><p>查</p>
<blockquote>
<p>select * from info where _id=’1’</p>
</blockquote>
</li>
<li><p>API的增删改查（推荐使用）</p>
</li>
</ul>
<p>##ListView </p>
<blockquote>
<p>解决大量的相似的数据显示的问题。<br>MVC：<br>M: modle 数据模型       50000个textview<br>V: view 显示的视图      xml–listview<br>C: controller 控制器    控制器，控制textview如何显示</p>
</blockquote>
<p>默认实现类</p>
<ul>
<li>BaseXXX</li>
<li>BasicXXX</li>
<li>SimpleXXX</li>
<li>DefaultXXX</li>
</ul>
<p>##listview的编写方法</p>
<ol>
<li>xml布局文件 声明listview的控件</li>
</ol>
<ol start="2">
<li>在代码里面查找listview<pre><code>findViewById（R.id.lv);
</code></pre></li>
<li>设置listview的数据适配器<pre><code>lv.setAdapter(new MyAdapter());
</code></pre></li>
<li>编写数据适配器<pre><code>private class MyAdapter extends BaseAdapter{ 
    public int getCount() {
        return ...;//告诉listview里面有多少条数据
    }
public View getView(int position, View convertView, ViewGroup parent) {
        return ...;//返回每个位置显示的view是什么样子的。
    }
}
</code></pre></li>
</ol>
<p>##常见的数据适配器</p>
<ul>
<li>ArrayAdapter 数组适配器</li>
</ul>
<p>##两种动画</p>
<ul>
<li>frame animation 帧动画</li>
<li>view动画</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/android学习记录2（日志、上下文、android下数据存储、xml基础）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/android学习记录2（日志、上下文、android下数据存储、xml基础）/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>软件测试</p>
<pre><code>黑盒测试

不知道软件的源代码。知道软件的需求和功能。 * 白盒测试 知道软件的源代码。

方法测试 （function test）
单元测试 （junit test）
集成测试 （intergration test）
系统测试 （system test）
</code></pre><p>android代码和javase区别</p>
<pre><code>运行环境 jvm dalvik
日志输出 console logcat
</code></pre><p>android下编写单元测试代码的步骤</p>
<pre><code>编写测试类，extends AndroidTestCase
编写测试方法， 修饰符是public，直接抛出异常给测试框架 throws Exception
进行断言
清单文件配置 在application节点配置&lt;uses-library android:name=&quot;android.test.runner&quot;/&gt; 在manifest节点里面配置&lt;instrumentation android:name=&quot;android.test.InstrumentationTestRunner&quot; android:targetPackage=&quot;当前应用程序的包名&quot;&gt;
运行测试用例。绿条测试通过，红条测试失败。
</code></pre><p>日志等级的划分</p>
<p>v: verbose 提醒 黑色。 Log.v(); </p>
<p>d: debug 调试 蓝色 Log.d();</p>
<p> i: info 信息 绿色 Log.i(); </p>
<p>w: warn 警告 橘黄 Log.w(); </p>
<p>e: error 错误 红色 Log.e();<br>上下文</p>
<pre><code>context 什么是上下文？ Toast.makeText（context,text,length).show(); 一个全局的环境对象，提供了很多方便的操作，帮助我们快速的获取数据，进行一些常规的操作。
</code></pre><p>android下文件的存储</p>
<pre><code>文件只能存储在自己应用程序私有的文件夹下，别的应用程序无法访问
this.getFilesDir() == /data/data/包名/files/
this.getCacheDir()== /data/data/包名/cache/
this.openFileInput（）；
this.openFileOutput（）；
</code></pre><p>android下的存储空间</p>
<pre><code>内部存储 类似电脑的固态硬盘
外部存储 sd卡

记得添加权限，检查外部存储设备的状态
</code></pre><p>参数 sharedpreference</p>
<pre><code>用来保存用户的配置信息和简单的数据 

1. 声明 SharedPreferences sp;

 2. 初始化 sp = this.getSharedPreferences(&quot;文件名&quot;, 0);//0代表的是私有 

3. 获取sp的编辑器 Editor editor = sp.edit(); 

4. 存储数据 editer.putString() putBoolean putLong 

5. 最后一步重要，一定要记得commit() 数据才被保存
</code></pre><p>android下文件访问的权限</p>
<pre><code>默认情况下所有的文件创建出来都是私有的。只有自己的应用程序可以访问里面的数据，别的应用程序是不可以访问数据的。
特殊情况利用api可以修改文件的权限。 openFileOutput(&quot;文件名&quot;，&quot;文件的访问模式&quot;); 私有 只读 只写 可读可写
底层是通过Linux操作系统的文件模式来实现的。
 mode
</code></pre><p>xml文件</p>
<p>用元素描述数据，跨平台。<br>生成xml文件的步骤</p>
<pre><code>初始化一个xml的序列化器 XmlSerializer serializer = Xml.newSerializer();
设置序列化器的参数 serializer.setOutput(os, &quot;utf-8&quot;);
写数据 serializer.startDocument(&quot;utf-8&quot;, true); 写文档头 serializer.endDocument();写文档末尾 serializer.startTag（命名空间，数据）；写某个标签 serializer.endTag(null, &quot;num&quot;); serializer.text()写文本数据
</code></pre><p>解析xml文件</p>
<pre><code>sax 基于事件
dom&amp;dom4j 把xml加载到内存
pull解析（类似于sax但是效率更高，内存开销更小）
</code></pre><p>读取xml文件</p>
<pre><code>初始化一个xml的解析器 XmlPullParser parser = Xml.newPullParser();
设置解析器的参数 InputStream inputStream = this.getAssets().open(&quot;10001.xml&quot;); parser.setInput(inputStream, &quot;utf-8&quot;);
读数据
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/Android图片的三级缓存和AsyncTask的使用的研究学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/Android图片的三级缓存和AsyncTask的使用的研究学习/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>图片的三级缓存</p>
<p>1、优先从内存中加载图片, 速度最快, 不浪费流量</p>
<p>2、其次从本地(sdcard)加载图片, 速度快, 不浪费流量</p>
<p>3、最后从网络下载图片, 速度慢, 浪费流量</p>
<p>XUtils中的BitmapUtils 等开源框架中底层都做了图片的三级缓存。</p>
<p>接下来，我们试着自己写一个类似于BitmapUtils 图片三级缓存工具类。</p>
<p>MyBitmapUtils.java</p>
<pre><code>/**
 * 自定义三级缓存图片加载工具
  * 
    */
public class MyBitmapUtils {
private NetCacheUtils mNetCacheUtils;//网络缓存工具类
private LocalCacheUtils mLocalCacheUtils;//本地缓存工具类
private MemoryCacheUtils mMemoryCacheUtils;

public MyBitmapUtils() {
    mMemoryCacheUtils = new MemoryCacheUtils();
    mLocalCacheUtils = new LocalCacheUtils();
    mNetCacheUtils = new NetCacheUtils(mLocalCacheUtils, mMemoryCacheUtils);
}

public void display(ImageView imageView, String url) {
    // 设置默认图片
    imageView.setImageResource(R.drawable.pic_item_list_default);

    // 优先从内存中加载图片, 速度最快, 不浪费流量
    Bitmap bitmap = mMemoryCacheUtils.getMemoryCache(url);
    if (bitmap != null) {
        imageView.setImageBitmap(bitmap);
        System.out.println(&quot;从内存加载图片啦&quot;);
        return;
    }

    // 其次从本地(sdcard)加载图片, 速度快, 不浪费流量
    bitmap = mLocalCacheUtils.getLocalCache(url);
    if (bitmap != null) {
        imageView.setImageBitmap(bitmap);
        System.out.println(&quot;从本地加载图片啦&quot;);

        // 写内存缓存
        mMemoryCacheUtils.setMemoryCache(url, bitmap);
        return;
    }

    // 最后从网络下载图片, 速度慢, 浪费流量
    mNetCacheUtils.getBitmapFromNet(imageView, url);
}
</code></pre><p>}</p>
<p>NetCacheUtils.java</p>
<p>网络缓存类<br>其中用了AsyncTask异步访问网络请求</p>
<pre><code>/**
  * 网络缓存
 * 
    */
public class NetCacheUtils {

private LocalCacheUtils mLocalCacheUtils;
private MemoryCacheUtils mMemoryCacheUtils;

public NetCacheUtils(LocalCacheUtils localCacheUtils,
        MemoryCacheUtils memoryCacheUtils) {
    mLocalCacheUtils = localCacheUtils;
    mMemoryCacheUtils = memoryCacheUtils;
}

public void getBitmapFromNet(ImageView imageView, String url) {
    // AsyncTask 异步封装的工具, 可以实现异步请求及主界面更新(对线程池+handler的封装)
    new BitmapTask().execute(imageView, url);// 启动AsyncTask
}

/**
 * 三个泛型意义: 第一个泛型:doInBackground里的参数类型 
 * 第二个泛型:  onProgressUpdate里的参数类型
 * 第三个泛型:  onPostExecute里的参数类型及doInBackground的返回类型
 * 
 */
class BitmapTask extends AsyncTask&lt;Object, Integer, Bitmap&gt; {

    private ImageView imageView;
    private String url;

    // 1.预加载, 运行在主线程
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        // System.out.println(&quot;onPreExecute&quot;);
    }

    // 2.正在加载, 运行在子线程(核心方法), 可以直接异步请求
    @Override
    protected Bitmap doInBackground(Object... params) {
        // System.out.println(&quot;doInBackground&quot;);
        imageView = (ImageView) params[0];
        url = (String) params[1];

        imageView.setTag(url);// 打标记, 将当前imageview和url绑定在了一起

        // 开始下载图片
        Bitmap bitmap = download(url);
        // publishProgress(values) 调用此方法实现进度更新(会回调onProgressUpdate)

        return bitmap;
    }

    // 3.更新进度的方法, 运行在主线程
    @Override
    protected void onProgressUpdate(Integer... values) {
        // 更新进度条
        super.onProgressUpdate(values);
    }

    // 4.加载结束, 运行在主线程(核心方法), 可以直接更新UI
    @Override
    protected void onPostExecute(Bitmap result) {
        // System.out.println(&quot;onPostExecute&quot;);

        if (result != null) {
            // 给imageView设置图片
            // 由于listview的重用机制导致imageview对象可能被多个item共用,
            // 从而可能将错误的图片设置给了imageView对象
            // 所以需要在此处校验, 判断是否是正确的图片
            String url = (String) imageView.getTag();

            if (url.equals(this.url)) {// 判断图片绑定的url是否就是当前bitmap的url                                                                               // 如果是,说明图片正确
                imageView.setImageBitmap(result);
                System.out.println(&quot;从网络加载图片啦!!!&quot;);

                // 写本地缓存
                mLocalCacheUtils.setLocalCache(url, result);
                // 写内存缓存
                mMemoryCacheUtils.setMemoryCache(url, result);
            }
        }
        super.onPostExecute(result);
    }
}
// 下载图片
public Bitmap download(String url) {
    HttpURLConnection conn = null;
    try {
        conn = (HttpURLConnection) new URL(url).openConnection();

        conn.setRequestMethod(&quot;GET&quot;);
        conn.setConnectTimeout(5000);// 连接超时
        conn.setReadTimeout(5000);// 读取超时

        conn.connect();

        int responseCode = conn.getResponseCode();

        if (responseCode == 200) {
            InputStream inputStream = conn.getInputStream();

            // 根据输入流生成bitmap对象
            Bitmap bitmap = BitmapFactory.decodeStream(inputStream);

            return bitmap;
        }
    } catch (MalformedURLException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        if (conn != null) {
            conn.disconnect();
        }
    }

    return null;
}
</code></pre><p>}</p>
<p>LocalCacheUtils.java </p>
<p>本地缓存类</p>
<p>   /**</p>
<pre><code> * 本地缓存
 */
public class LocalCacheUtils {

private static final String LOCAL_CACHE_PATH = Environment
        .getExternalStorageDirectory().getAbsolutePath() + &quot;/image_cache&quot;;

// 写本地缓存
public void setLocalCache(String url, Bitmap bitmap) {
    File dir = new File(LOCAL_CACHE_PATH);
    if (!dir.exists() || !dir.isDirectory()) {
        dir.mkdirs();// 创建文件夹
    }

    try {
        String fileName = MD5Encoder.encode(url);

        File cacheFile = new File(dir, fileName);

        bitmap.compress(CompressFormat.JPEG, 100, new FileOutputStream(
            cacheFile));// 参数1:图片格式;参数2:压缩比例0-100; 参数3:输出流
    } catch (Exception e) {
        e.printStackTrace();
    }
}

// 读本地缓存
public Bitmap getLocalCache(String url) {
    try {
        File cacheFile = new File(LOCAL_CACHE_PATH, MD5Encoder.encode(url));

        if (cacheFile.exists()) {
            Bitmap bitmap = BitmapFactory.decodeStream(new FileInputStream(
                    cacheFile));
            return bitmap;
        }

    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
}
</code></pre><p>}</p>
<p>MemoryCacheUtils.java  内存缓存类</p>
<pre><code>    /**
       * 内存缓存
      */
public class MemoryCacheUtils {

private HashMap&lt;String, Bitmap&gt; mMemoryCache = new HashMap&lt;String,Bitmap&gt;();

/**
 * 写缓存
 */
public void setMemoryCache(String url, Bitmap bitmap) {    
    mMemoryCache.put(url, bitmap);
}

/**
 * 读缓存
 */
public Bitmap getMemoryCache(String url) {

    return mMemoryCache.get(url);
}
</code></pre><p>}</p>
<p>但是由于不管android设备总内存是多大, 都只给每个app分配一定内存大小, 16M, 一旦超出16M就内存溢出了。所以内存缓存图片数量过多就会OOM。于是尝试采用软引用SoftReference修改内存缓存类，修改如下：</p>
<pre><code>/**
 * 内存缓存
  */
public class MemoryCacheUtils {
private HashMap&lt;String, SoftReference&lt;Bitmap&gt;&gt; mMemoryCache = new HashMap&lt;String, SoftReference&lt;Bitmap&gt;&gt;();
/**
 * 写缓存
 */
public void setMemoryCache(String url, Bitmap bitmap) {
     SoftReference&lt;Bitmap&gt; soft = new SoftReference&lt;Bitmap&gt;(bitmap);//
    // 使用软引用将bitmap包装起来
     mMemoryCache.put(url, soft);    
}

/**
 * 读缓存
 */
public Bitmap getMemoryCache(String url) {
     SoftReference&lt;Bitmap&gt; softReference = mMemoryCache.get(url);

     if (softReference != null) {
     Bitmap bitmap = softReference.get();
     return bitmap;
     }
    return null;
}
</code></pre><p>}</p>
<p>tip：</p>
<ul>
<li>默认强引用, 垃圾回收器不会回收</li>
<li>软引用, 垃圾回收器会考虑回收 SoftReference</li>
<li>弱引用, 垃圾回收器更会考虑回收 WeakReference</li>
<li>虚引用, 垃圾回收器最优先回收 PhantomReference</li>
</ul>
<p>但是又因为从 Android 2.3 (API Level 9)开始，垃圾回收器会更倾向于回收持有软引用或弱引用的对象，这让软引用和弱引用变得不再可靠。Google建议使用LruCache。</p>
<p>下面这个是官方文档的截图：</p>
<p>所以再次修改喽~</p>
<p>修改如下：</p>
<pre><code>/**
   * 内存缓存
   * 因为从 Android 2.3 (API Level 9)开始，垃圾回收器会更倾向于    回收持有软引用或弱引用的对象，这让 

   * 软引用和弱引用变得不再可靠。Google建议使用LruCache
  */
public class MemoryCacheUtils {

// private HashMap&lt;String, Bitmap&gt; mMemoryCache = new HashMap&lt;String,
// Bitmap&gt;();
// private HashMap&lt;String, SoftReference&lt;Bitmap&gt;&gt; mMemoryCache = new
// HashMap&lt;String, SoftReference&lt;Bitmap&gt;&gt;();

private LruCache&lt;String, Bitmap&gt; mMemoryCache;

public MemoryCacheUtils() {
    // LruCache 可以将最近最少使用的对象回收掉, 从而保证内存不会超出范围
    // Lru: least recentlly used 最近最少使用算法
    long maxMemory = Runtime.getRuntime().maxMemory();// 获取分配给app的内存大小
    System.out.println(&quot;maxMemory:&quot; + maxMemory);

    mMemoryCache = new LruCache&lt;String, Bitmap&gt;((int) (maxMemory / 8)) {

        // 返回每个对象的大小
        @Override
        protected int sizeOf(String key, Bitmap value) {
            // int byteCount = value.getByteCount();
            int byteCount = value.getRowBytes() * value.getHeight();// 计算图片大小:每行字节数*高度
            return byteCount;
        }
    };
}

/**
 * 写缓存
 */
public void setMemoryCache(String url, Bitmap bitmap) {
    // mMemoryCache.put(url, bitmap);
    // SoftReference&lt;Bitmap&gt; soft = new SoftReference&lt;Bitmap&gt;(bitmap);//
    // 使用软引用将bitmap包装起来
    // mMemoryCache.put(url, soft);
    mMemoryCache.put(url, bitmap);
}

/**
 * 读缓存
 */
public Bitmap getMemoryCache(String url) {
    // SoftReference&lt;Bitmap&gt; softReference = mMemoryCache.get(url);
    //
    // if (softReference != null) {
    // Bitmap bitmap = softReference.get();
    // return bitmap;
    // }
    return mMemoryCache.get(url);
}
</code></pre><p>}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/Android属性动画(ObjectAnimator、PropertyValuesHolder、ValueAnimator、AnimatorSet)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/Android属性动画(ObjectAnimator、PropertyValuesHolder、ValueAnimator、AnimatorSet)/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Android属性动画"><a href="#Android属性动画" class="headerlink" title="Android属性动画"></a>Android属性动画</h3><p>　　在Animator 框架中，使用最多的就是AnimatorSet和ObjectAnimator配合，使用ObjectAnimator进行更加精细的控制，只控制一个对象的一个属性值，尔斯用多个ObjectAnimator组合到AnimatorSet形成一个动画。而且ObjectAnimator能够自动驱动，可以调用setFrameDelay(longframeDelay)设置动画帧之间的见习时间，调整帧率，减少动画过程中频繁绘制界面，而在不影响动画效果的前提下减少CPU的资源消耗。最重要的是，属性动画是通过调用get、set方法来真实的控制各View的属性值，基本可以实现所有的动画效果。所以View必须要提供setXxx方法，如果动画的时候没有传递初始值，那么还要提供getXxx方法，因为系统要去拿xxx属性的初始值（如果这条不满足，程序直接Crash） 。View的setXxx对属性xxx所做的改变必须能够通过某种方法反映出来，比如会带来ui的改变啥的（如果这条不满足，动画无效果但不会Crash）。<br>举一个最简单的例子：<br><img src="http://img.blog.csdn.net/20160504142348712" alt="这里写图片描述"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ObjectAnimator animator = ObjectAnimator.ofFloat(btn1, &quot;translationX&quot;, 0, 500); </span><br><span class="line">animator.setDuration(3000);</span><br><span class="line">animator.start();</span><br></pre></td></tr></table></figure></p>
<p>　　ObjectAnimator.ofFloat(btn1, “translationX”, 0, 500); 这里第一个参数是要操纵的view，我的是一个button，第二个参数是要操纵的属性，最后一个参数是一个可变数组参数，传入属性变化的取值过程。和视图动画一样可以设置动画时长等属性。</p>
<p>常见的属性值：translationX、translationY：view对象从他布局容器的左上角坐标偏移的位置<br>　　　　　　　rotation、rotationX、rotationY：控制view围绕支点进行2D、3D的旋转<br>　　　　　　　scaleX、scaleY：控制view对象围绕支点进行2D缩放<br>　　　　　　　pivotX、pivotY：view对象的支点位置，围绕这个支点旋转缩放，默认为view对象的中心店<br>　　　　　　　x、y：view在容器中的位置<br>　　　　　　　alpha：view的透明度<br>　　　　　　　<br>　　ObjectAnimator.ofFloat使用时要注意属性的数据类型，比如translationX属性使用了ObjectAnimator.ofInt(….)方法时，就会被认为报<strong>Method setTranslationX() with type int not found on target class</strong> 错误；同样一个属性没有对应get、set方法时，属性动画是不是就没办法了呢？答案肯定是否定的。可以通过一个自定义属性类或者包装类来间接的给这个属性增加get、set方法。<br>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">private static class ViewWrapper &#123;</span><br><span class="line">        private View mTarget;</span><br><span class="line"></span><br><span class="line">        public ViewWrapper(View target) &#123;</span><br><span class="line">            mTarget = target;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public int getWidth() &#123;</span><br><span class="line">            return mTarget.getLayoutParams().width;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void setWidth(int width) &#123;</span><br><span class="line">            mTarget.getLayoutParams().width = width;</span><br><span class="line">            mTarget.requestLayout();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>这样就给属性包装了一层，使用时只要操纵包装类即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ViewWrapper wrapper = new ViewWrapper(mButton);</span><br><span class="line">      ObjectAnimator.ofInt(wrapper, width, 500).setDuration(5000).start();</span><br></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20160504143835311" alt="这里写图片描述"></p>
<p>###PropertyValuesHolder<br>　　在视图动画中用AnimationSet可以实现多个动画一起执行，在属性动画中，针对一个对象的多个属性进行操控，完成类似AnimationSet的效果可以通过PropertyValuesHolder来实现。<br>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PropertyValuesHolder pvh1 = PropertyValuesHolder.ofFloat(&quot;scaleX&quot;, 1f, 0, 1f); </span><br><span class="line">      PropertyValuesHolder pvh2 = PropertyValuesHolder.ofFloat(&quot;scaleY&quot;, 1f, 0, 1f);</span><br><span class="line">      PropertyValuesHolder pvh3 = PropertyValuesHolder.ofFloat(&quot;translationX&quot;,0, 500);</span><br><span class="line">      ObjectAnimator.ofPropertyValuesHolder(view,pvh1,pvh2,pvh3).setDuration(3000).start();</span><br></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20160504144059265" alt="这里写图片描述"></p>
<p>###ValueAnimator<br>　　 ValueAnimator在属性动画中占非常重要的地位。他本身不提供任何动画效果，它更像一个数值发生器，用来产生一定规律的数字，从而让调动着来控制动画的实践过程。ValueAnimator的一般使用方法如下所示，通常情况下，在ValueAnimator的AnimatorUpdateListenerListener中监听数值的变化，从而完成动画的变换。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ValueAnimator animator = ValueAnimator.ofFloat(0,100);</span><br><span class="line">      animator.setTarget(view);</span><br><span class="line">      animator.setDuration(1000).start();</span><br><span class="line">      animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">          @Override</span><br><span class="line">          public void onAnimationUpdate(ValueAnimator animation) &#123;</span><br><span class="line">              Float value = (Float)animation.getAnimatedValue();</span><br><span class="line">              //use the value</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br></pre></td></tr></table></figure>
<p>###动画的监听<br>一个完整的动画有Start、Repat、End、Cancel四个过程，通过Android提供了接口，可以很方便的监听这四个事件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">animator.addListener(new Animator.AnimatorListener() &#123;</span><br><span class="line">           @Override</span><br><span class="line">           public void onAnimationStart(Animator animation) &#123; </span><br><span class="line">           &#125;</span><br><span class="line">           @Override</span><br><span class="line">           public void onAnimationEnd(Animator animation) &#123;</span><br><span class="line">           &#125;</span><br><span class="line">           @Override</span><br><span class="line">           public void onAnimationCancel(Animator animation) &#123;</span><br><span class="line">           &#125;</span><br><span class="line">           @Override</span><br><span class="line">           public void onAnimationRepeat(Animator animation) &#123;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure>
<p>　　 大部分时候只关心onAnimationEnd事件，所以Android也提供了一个animatorListenerAdapter来让我们选择必要时间进行监听：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">animator.addListener(new AnimatorListenerAdapter() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onAnimationEnd(Animator animation) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>###AnimatorSet<br> 　　 对于一个属性同时作用多个属性动画效果，可以用PropertyValuesHolder实现，但是用AnimatorSet不仅能实现这样的效果还可以更加精确的顺序控制。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ObjectAnimator animator1 = ObjectAnimator.ofFloat(view, &quot;translationX&quot;,500f); </span><br><span class="line">      ObjectAnimator animator2 = ObjectAnimator.ofFloat(view, &quot;scaleX&quot;,1f,0f,1f);</span><br><span class="line">      ObjectAnimator animator3 = ObjectAnimator.ofFloat(view, &quot;scaleY&quot;,1f,0f,1f);</span><br><span class="line">      AnimatorSetset = new AnimatorSet();</span><br><span class="line">      set.setDuration(2000);</span><br><span class="line">      set.playSequentially(animator1,animator2,animator3);</span><br><span class="line">      set.start();</span><br></pre></td></tr></table></figure></p>
<p><img src="http://img.blog.csdn.net/20160504144256970" alt="这里写图片描述"></p>
<p> 　　在属性动画中AnimatorSet正是通过playTogether()、playSequentially()、animSet.play().with()、before()、after()这些方法来控制多个动画协同工作，从而做到对动画播放顺序的精确控制。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/AndroidStudio插件GsonFormat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/AndroidStudio插件GsonFormat/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1、下载安装GsonFormat插件<br>在Android Studio 的setting里点击plugins，选择browse repositories…如下图<br><img src="http://img.blog.csdn.net/20160519165610428" alt="这里写图片描述"><br>搜索GsonFormat，点击安装<br><img src="http://img.blog.csdn.net/20160519165756430" alt="这里写图片描述"><br>重启Android Studio<br>2、使用GsonFormat<br>    点击code里的Generate…<br><img src="http://img.blog.csdn.net/20160519170006573" alt="这里写图片描述"><br>选择GsonFormat<br><img src="http://img.blog.csdn.net/20160519170432757" alt="这里写图片描述"></p>
<p>将json复制进去，点击ok即可<br><img src="http://img.blog.csdn.net/20160519170508632" alt="这里写图片描述"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/Android 文件读写工具类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/Android 文件读写工具类/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>自己写的工具类，写的不好，慢慢修改。</p>
<p>记得加上权限<br><code>&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;
                &lt;uses-permission android:name=&quot;android.permission.MOUNT_UNMOUNT_FILESYSTEMS&quot; /&gt;</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line">package com.sy.utils;</span><br><span class="line"></span><br><span class="line">import android.content.Context;</span><br><span class="line">import android.os.Environment;</span><br><span class="line">import android.os.StatFs;</span><br><span class="line">import android.util.Log;</span><br><span class="line"></span><br><span class="line">import java.io.BufferedInputStream;</span><br><span class="line">import java.io.BufferedOutputStream;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileInputStream;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.io.OutputStream;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by SY on 2016/5/9.</span><br><span class="line"> * 文件读写工具类</span><br><span class="line"> */</span><br><span class="line">public class FileUtils &#123;</span><br><span class="line"></span><br><span class="line">    private Context context;</span><br><span class="line">    private String SDCardPath = Environment.getExternalStorageDirectory().getAbsolutePath();//sd卡路径</span><br><span class="line">    private static String SDState = Environment.getExternalStorageState();//SD卡状态</span><br><span class="line"></span><br><span class="line">    public FileUtils(Context context) &#123;</span><br><span class="line">        this.context = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 文件存储到/data/data/&lt;packagename&gt;/files/默认目录下</span><br><span class="line">     *</span><br><span class="line">     * @param fileName</span><br><span class="line">     * @param bytes</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public boolean write2CacheFile(String fileName, byte[] bytes) &#123;</span><br><span class="line"></span><br><span class="line">        FileOutputStream out = null;</span><br><span class="line">        BufferedOutputStream bos = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            out = context.openFileOutput(fileName, Context.MODE_PRIVATE);</span><br><span class="line"></span><br><span class="line">            bos = new BufferedOutputStream(out);</span><br><span class="line">            bos.write(bytes);</span><br><span class="line">            bos.flush();</span><br><span class="line">            return true;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (bos != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    bos.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 向SD卡里写字节</span><br><span class="line">     *</span><br><span class="line">     * @param path 文件夹目录</span><br><span class="line">     * @param file 文件名</span><br><span class="line">     * @param data 写入的字节数组</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static boolean writeBytes(String path, String file, byte[] data) &#123;</span><br><span class="line">        FileOutputStream fos = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            // 拥有足够的容量</span><br><span class="line">            if (data.length &lt; getSDFreeSize()) &#123;</span><br><span class="line">                createDirectoryIfNotExist(path);</span><br><span class="line">                createFileIfNotExist(path + file);</span><br><span class="line"></span><br><span class="line">                fos = new FileOutputStream(path + File.separator + file);</span><br><span class="line">                fos.write(data);</span><br><span class="line">                fos.flush();</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            Log.e(&quot;writeBytes&quot;, e.getMessage());</span><br><span class="line">        &#125;finally &#123;</span><br><span class="line">            if (fos != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    fos.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 从SD卡里读取字节数组</span><br><span class="line">     *</span><br><span class="line">     * @param path     目录</span><br><span class="line">     * @param fileName 文件名</span><br><span class="line">     * @return 返回字节数组，文件不存在返回null</span><br><span class="line">     */</span><br><span class="line">    public static byte[] readBytes(String path, String fileName) &#123;</span><br><span class="line">        File file = new File(path + File.separator + fileName);</span><br><span class="line">        if (!file.exists()) &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">        InputStream inputStream = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            inputStream = new BufferedInputStream(new FileInputStream(file));</span><br><span class="line">            byte[] data = new byte[inputStream.available()];</span><br><span class="line">            inputStream.read(data);</span><br><span class="line">            return data;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                if (inputStream != null) &#123;</span><br><span class="line">                    inputStream.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 将一个字节流写入到SD卡文件</span><br><span class="line">     *</span><br><span class="line">     * @param path     目录路径</span><br><span class="line">     * @param fileName 文件名</span><br><span class="line">     * @param input    字节流</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line"></span><br><span class="line">    public static Boolean write2SDFromInput(String path, String fileName, InputStream input) &#123;</span><br><span class="line">        File file = null;</span><br><span class="line">        OutputStream output = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            int size = input.available();</span><br><span class="line">            // 拥有足够的容量</span><br><span class="line">            if (size &lt; getSDFreeSize()) &#123;</span><br><span class="line">                createDirectoryIfNotExist(path);</span><br><span class="line">                createFileIfNotExist(path + File.separator + fileName);</span><br><span class="line">                file = new File(path + File.separator + fileName);</span><br><span class="line">                output = new BufferedOutputStream(new FileOutputStream(file));</span><br><span class="line">                byte buffer[] = new byte[1024];</span><br><span class="line">                int temp;</span><br><span class="line">                while ((temp = input.read(buffer)) != -1) &#123;</span><br><span class="line">                    output.write(buffer, 0, temp);</span><br><span class="line">                &#125;</span><br><span class="line">                output.flush();</span><br><span class="line">                return true;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e1) &#123;</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                if (output != null) &#123;</span><br><span class="line">                    output.close();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 判断SD卡是否存在</span><br><span class="line">     *</span><br><span class="line">     * @ return</span><br><span class="line">     */</span><br><span class="line">    private static boolean SDCardisExist() &#123;</span><br><span class="line">        if (SDState.equals(Environment.MEDIA_MOUNTED)) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125; else</span><br><span class="line">            return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取SD卡剩余容量大小（单位Byte）</span><br><span class="line">     *</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static long getSDFreeSize() &#123;</span><br><span class="line">        //取得SD卡文件路径</span><br><span class="line">        File path = Environment.getExternalStorageDirectory();</span><br><span class="line">        StatFs sf = new StatFs(path.getPath());</span><br><span class="line">        //获取单个数据块的大小(Byte)</span><br><span class="line">        long blockSize = sf.getBlockSize();</span><br><span class="line">        //空闲的数据块的数量</span><br><span class="line">        long freeBlocks = sf.getAvailableBlocks();</span><br><span class="line">        //返回SD卡空闲大小</span><br><span class="line">        return freeBlocks * blockSize;  //单位Byte</span><br><span class="line">        //return (freeBlocks * blockSize)/1024;   //单位KB</span><br><span class="line">//        return (freeBlocks * blockSize) / 1024 / 1024; //单位MB</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 获取SD卡总容量大小（单位Byte）</span><br><span class="line">     *</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static long getSDAllSize() &#123;</span><br><span class="line">        //取得SD卡文件路径</span><br><span class="line">        File path = Environment.getExternalStorageDirectory();</span><br><span class="line">        StatFs sf = new StatFs(path.getPath());</span><br><span class="line">        //获取单个数据块的大小(Byte)</span><br><span class="line">        long blockSize = sf.getBlockSize();</span><br><span class="line">        //获取所有数据块数</span><br><span class="line">        long allBlocks = sf.getBlockCount();</span><br><span class="line">        //返回SD卡大小</span><br><span class="line">        return allBlocks * blockSize; //单位Byte</span><br><span class="line">        //return (allBlocks * blockSize)/1024; //单位KB</span><br><span class="line">//        return (allBlocks * blockSize) / 1024 / 1024; //单位MB</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 如果目录不存在，就创建目录</span><br><span class="line">     *</span><br><span class="line">     * @param path 目录</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static boolean createDirectoryIfNotExist(String path) &#123;</span><br><span class="line">        File file = new File(path);</span><br><span class="line">        //如果文件夹不存在则创建</span><br><span class="line">        if (!file.exists() &amp;&amp; !file.isDirectory()) &#123;</span><br><span class="line">            return file.mkdirs();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Log.e(&quot;目录&quot;, &quot;目录存在！&quot;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 如果文件不存在，就创建文件</span><br><span class="line">     * @param path 文件路径</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public static boolean createFileIfNotExist(String path) &#123;</span><br><span class="line">        File file = new File(path);</span><br><span class="line">        try &#123;</span><br><span class="line">            if (!file.exists()) &#123;</span><br><span class="line">                return file.createNewFile();</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                Log.e(&quot;文件&quot;, &quot;文件存在！&quot;);</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            Log.e(&quot;error&quot;, e.getMessage());</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/Android Notification 通知/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/Android Notification 通知/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这是Android 通知相关的内容的总结<br>android中通知用到的地方很多，经常有的例如推送消息，下载时的提示等。</p>
<p>###Android 3.0 (API level 11)之前：<br>使用new Notification()方式创建通知:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NotificationManager mNotifyManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);</span><br><span class="line">PendingIntent contentIntent = PendingIntent.getActivity( this, 0, new Intent(this, Main2Activity.class), 0); </span><br><span class="line">Notification notification = new Notification(icon, tickerText, when); </span><br><span class="line">notification.setLatestEventInfo(this, title, content, contentIntent); </span><br><span class="line">mNotifyManager .notify(NOTIFICATIONS_ID, notification);</span><br></pre></td></tr></table></figure>
<p>###Android 3.0 (API level 11)以后<br>Android 3.0开始弃用new Notification()方式，改用Notification.Builder()来创建通知:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NotificationManager mNotifyManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE); </span><br><span class="line">PendingIntent contentIntent = PendingIntent.getActivity( this, 0, new Intent(this, Main2Activity.class), 0); </span><br><span class="line">Notification notification = new Notification.Builder(this) .setSmallIcon(R.drawable.notification_icon) </span><br><span class="line">.setContentTitle(&quot;My Title&quot;) </span><br><span class="line">.setContentText(&quot;ContentText&quot;) </span><br><span class="line">.setContentIntent(contentIntent) .build();</span><br><span class="line">mNotifyManager.notify(NOTIFICATIONS_ID, notification);</span><br></pre></td></tr></table></figure>
<p>为了兼容API level 11之前的版本，v4 Support Library中提供了<br>NotificationCompat.Builder()这个替代方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NotificationManager mNotifyManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE); </span><br><span class="line">PendingIntent contentIntent = PendingIntent.getActivity( this, 0, new Intent(this, Main2Activity.class), 0); </span><br><span class="line">NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(this) .setSmallIcon(R.drawable.notification_icon) </span><br><span class="line">.setContentTitle(&quot;My Title&quot;) </span><br><span class="line">.setContentText(&quot;ContentText&quot;) </span><br><span class="line">.setContentIntent(contentIntent); </span><br><span class="line">mNotifyManager.notify(NOTIFICATIONS_ID, mBuilder.build());</span><br></pre></td></tr></table></figure>
<p>###普通通知</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> Intent hangIntent = new Intent(context, Main2Activity.class);</span><br><span class="line">        hangIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">        PendingIntent intent = PendingIntent.getActivity(context, 0, hangIntent, PendingIntent.FLAG_CANCEL_CURRENT);</span><br><span class="line">         NotificationCompat.Builder builder = new NotificationCompat.Builder(getApplicationContext())</span><br><span class="line">                .setSmallIcon(R.mipmap.timg)</span><br><span class="line">                .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.mipmap.timg))</span><br><span class="line">                .setAutoCancel(true)</span><br><span class="line">                .setSubText(subText + &quot;getNormalNotification&quot;)</span><br><span class="line">                .setTicker(ticker)</span><br><span class="line">                .setShowWhen(true)</span><br><span class="line">                .setVisibility(Notification.VISIBILITY_PUBLIC)</span><br><span class="line">                .setDefaults(Notification.DEFAULT_ALL)</span><br><span class="line">                .setContentIntent(intent)</span><br><span class="line">                .setContentText(content)</span><br><span class="line">                .setContentTitle(title);</span><br><span class="line">NotificationManager manager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);</span><br><span class="line">		        manager.notify(1, notification);</span><br></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20180401160357400?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbW91c2UxMjEzOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>###进度条通知</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private NotificationManager getManager() &#123;</span><br><span class="line">    if (manager == null) &#123;</span><br><span class="line">        manager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);</span><br><span class="line">    &#125;</span><br><span class="line">    return manager;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Intent hangIntent = new Intent(context, Main2Activity.class);</span><br><span class="line">      hangIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">      PendingIntent intent = PendingIntent.getActivity(context, 0, hangIntent, PendingIntent.FLAG_CANCEL_CURRENT);</span><br><span class="line">      final NotificationCompat.Builder builder = new NotificationCompat.Builder(getApplicationContext())</span><br><span class="line">              .setSmallIcon(R.mipmap.timg)</span><br><span class="line">              .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.mipmap.timg))</span><br><span class="line">              .setAutoCancel(true)</span><br><span class="line">              .setTicker(ticker)</span><br><span class="line">              .setContentIntent(intent)</span><br><span class="line">              .setContentText(content + &quot;getDownloadNotification&quot;)</span><br><span class="line">              .setContentTitle(title);</span><br><span class="line">      new Thread(new Runnable() &#123;</span><br><span class="line">          @Override</span><br><span class="line">          public void run() &#123;</span><br><span class="line">              int progress;</span><br><span class="line">              for (progress = 0; progress &lt;= 100; progress += 5) &#123;</span><br><span class="line">                  builder.setProgress(100, progress, false);</span><br><span class="line">                  builder.setContentInfo(progress + &quot;%&quot;);</span><br><span class="line">                  getManager().notify(1, builder.build());</span><br><span class="line">                  try &#123;</span><br><span class="line">                      Thread.sleep(1 * 1000);</span><br><span class="line">                  &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                      e.printStackTrace();</span><br><span class="line">                  &#125;</span><br><span class="line">              &#125;</span><br><span class="line">              builder.setContentText(&quot;下载完成&quot;)</span><br><span class="line">                      .setProgress(0, 0, false).setContentInfo(&quot;&quot;);</span><br><span class="line">              getManager().notify(1, builder.build());</span><br><span class="line"></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;).start();</span><br></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20180401160834058?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbW91c2UxMjEzOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>###BigText通知</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Intent hangIntent = new Intent(context, Main2Activity.class);</span><br><span class="line">      hangIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">      PendingIntent intent = PendingIntent.getActivity(context, 0, hangIntent, PendingIntent.FLAG_CANCEL_CURRENT);</span><br><span class="line">      NotificationCompat.Builder builder = new NotificationCompat.Builder(getApplicationContext())</span><br><span class="line">              .setSmallIcon(R.mipmap.timg)</span><br><span class="line">              .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.mipmap.timg))</span><br><span class="line">              .setAutoCancel(true)</span><br><span class="line">              .setTicker(ticker)</span><br><span class="line">              .setVisibility(Notification.VISIBILITY_PUBLIC)</span><br><span class="line">              .setDefaults(Notification.DEFAULT_ALL);</span><br><span class="line"></span><br><span class="line">      NotificationCompat.BigTextStyle style = new NotificationCompat.BigTextStyle();</span><br><span class="line">      //bigText 给样式设置大文本内容</span><br><span class="line">      style.bigText(&quot;正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文正文&quot;);</span><br><span class="line">      //setBigContentTitle 给样式设置大文本的标题</span><br><span class="line">      style.setBigContentTitle(&quot;标题&quot;);</span><br><span class="line">      //SummaryText没什么用 可以不设置</span><br><span class="line">      style.setSummaryText(&quot;末尾的文字内容&quot;);</span><br><span class="line">      builder.setStyle(style).setContentIntent(intent)</span><br><span class="line">              .setContentText(content)</span><br><span class="line">              .setContentTitle(title);</span><br><span class="line">   getManager().notify(1, notification);</span><br></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20180401161135704?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbW91c2UxMjEzOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>###BigPicture通知</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Intent hangIntent = new Intent(context, Main2Activity.class);</span><br><span class="line">        hangIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">        PendingIntent intent = PendingIntent.getActivity(context, 0, hangIntent, PendingIntent.FLAG_CANCEL_CURRENT);</span><br><span class="line">        NotificationCompat.Builder builder = new NotificationCompat.Builder(getApplicationContext())</span><br><span class="line">                .setSmallIcon(R.mipmap.timg)</span><br><span class="line">                .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.mipmap.timg))</span><br><span class="line">                .setAutoCancel(true)</span><br><span class="line">                .setTicker(ticker)</span><br><span class="line">                .setVisibility(Notification.VISIBILITY_PUBLIC)</span><br><span class="line">                .setDefaults(Notification.DEFAULT_ALL);</span><br><span class="line"></span><br><span class="line">        NotificationCompat.BigPictureStyle style = new NotificationCompat.BigPictureStyle();</span><br><span class="line">        style.setBigContentTitle(&quot;BigContentTitle&quot;);</span><br><span class="line">        style.setSummaryText(&quot;SummaryText&quot;);</span><br><span class="line">        style.bigPicture(BitmapFactory.decodeResource(getResources(), R.mipmap.title));</span><br><span class="line">        builder.setStyle(style).setContentIntent(intent)</span><br><span class="line">                .setContentText(content)</span><br><span class="line">                .setContentTitle(title);</span><br><span class="line">       getManager().notify(1, notification);</span><br></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20180401161556810?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbW91c2UxMjEzOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>###悬挂通知</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Intent hangIntent = new Intent();</span><br><span class="line">        hangIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">        hangIntent.setClass(context, Main2Activity.class);</span><br><span class="line">        PendingIntent hangPendingIntent = PendingIntent.getActivity(context, 0, hangIntent, PendingIntent.FLAG_CANCEL_CURRENT);</span><br><span class="line">        NotificationCompat.Builder builder =  new NotificationCompat.Builder(getApplicationContext())</span><br><span class="line">                .setSmallIcon(R.mipmap.timg)</span><br><span class="line">                .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.mipmap.timg))</span><br><span class="line">                .setAutoCancel(true)</span><br><span class="line">                .setVisibility(VISIBILITY_PUBLIC)</span><br><span class="line">                .setFullScreenIntent(hangPendingIntent, true)</span><br><span class="line">                .setContentText(content)</span><br><span class="line">                .setContentTitle(title);</span><br><span class="line">        getManager().notify(1, notification);</span><br></pre></td></tr></table></figure>
<p><img src="http://img.blog.csdn.net/20180401162008134?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbW91c2UxMjEzOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>###5.0锁屏通知<br>Android 5.0(API level 21)开始，通知可以显示在锁屏上。用户可以通过设置选择是否允许敏感的通知内容显示在安全的锁屏上。<br>你的应用可以通过setVisibility()控制通知的显示等级:</p>
<pre><code>VISIBILITY_PRIVATE : 显示基本信息，如通知的图标，但隐藏通知的全部内容
VISIBILITY_PUBLIC : 显示通知的全部内容
VISIBILITY_SECRET : 不显示任何内容，包括图标
</code></pre><p><img src="http://img.blog.csdn.net/20180401162752865?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbW91c2UxMjEzOA==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>###Android8.0   适配通知栏<br>查看官方文档 <a href="https://developer.android.com/preview/features/notification-channels.html" target="_blank" rel="noopener">https://developer.android.com/preview/features/notification-channels.html</a></p>
<p>文档里是这样写的：</p>
<p>If you targetAndroid O and post a notification without specifying a valid notificationschannel, the notification fails to post and the system logs an error.</p>
<p>大意就是说，如果在Android O发送通知需要设置notificationchannel，否则通知会发送失败。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.O) &#123;</span><br><span class="line">    NotificationChannel channel = new NotificationChannel(&quot;通知渠道ID&quot;,</span><br><span class="line">                    &quot;通知渠道名称&quot;, NotificationManager.IMPORTANCE_DEFAULT);</span><br><span class="line">    channel.enableLights(true); //设置开启指示灯，如果设备有的话</span><br><span class="line">    channel.setLightColor(Color.RED); //设置指示灯颜色</span><br><span class="line">    channel.setShowBadge(true); //设置是否显示角标</span><br><span class="line">    channel.setLockscreenVisibility(Notification.VISIBILITY_PRIVATE);//设置是否应在锁定屏幕上显示此频道的通知</span><br><span class="line">    channel.setDescription(&quot;通知渠道描述&quot;);//设置渠道描述</span><br><span class="line">    channel.setVibrationPattern(new long[]&#123;100,200,300,400,500,600&#125;);//设置震动频率</span><br><span class="line">    channel.setBypassDnd(true);//设置是否绕过免打扰模式</span><br><span class="line">    mNotificationManager.createNotificationChannel(channel);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Intent hangIntent = new Intent(context, Main2Activity.class);</span><br><span class="line">      hangIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">      PendingIntent intent = PendingIntent.getActivity(context, 0, hangIntent, PendingIntent.FLAG_CANCEL_CURRENT);</span><br><span class="line">       NotificationCompat.Builder builder = new NotificationCompat.Builder(getApplicationContext())</span><br><span class="line">              .setSmallIcon(R.mipmap.timg)</span><br><span class="line">              .setLargeIcon(BitmapFactory.decodeResource(getResources(), R.mipmap.timg))</span><br><span class="line">              .setAutoCancel(true)</span><br><span class="line">              .setSubText(subText + &quot;getNormalNotification&quot;)</span><br><span class="line">              .setTicker(ticker)</span><br><span class="line">              .setShowWhen(true)</span><br><span class="line">              .setVisibility(Notification.VISIBILITY_PUBLIC)</span><br><span class="line">              .setDefaults(Notification.DEFAULT_ALL)</span><br><span class="line">              .setContentIntent(intent)</span><br><span class="line">              .setContentText(content)</span><br><span class="line">              .setContentTitle(title);</span><br><span class="line">        getManager().notify(1, notification);</span><br></pre></td></tr></table></figure>
<p>锁屏通知，悬挂通知等测试时记得要在手机里开启相关权限，很多手机权限默认关闭<br><img src="https://img-blog.csdn.net/20180401164728394?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21vdXNlMTIxMzg=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="这里写图片描述"></p>
<p>参考资料：<br>Android Notification 通知样式总结<br><a href="https://shoewann0402.github.io/2016/05/12/Android-Notification-%E9%80%9A%E7%9F%A5%E6%A0%B7%E5%BC%8F%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">https://shoewann0402.github.io/2016/05/12/Android-Notification-%E9%80%9A%E7%9F%A5%E6%A0%B7%E5%BC%8F%E6%80%BB%E7%BB%93/</a><br>Android通知栏介绍与适配总结<br><a href="https://blog.csdn.net/jiankeufo/article/details/77977564" target="_blank" rel="noopener">https://blog.csdn.net/jiankeufo/article/details/77977564</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/2D绘图基础/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/2D绘图基础/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>   系统通过提供的Canvas对象来提供绘图方法。提供可很多API，如：drawPoint、drawLine、drawRect、drawVertices、drawArc、drawCircle等。<br>关于Paint的一些属性设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">setAntiALias() ;                     //设置画笔的锯齿效果</span><br><span class="line">            setColor();                          //设置画笔的颜色</span><br><span class="line">            setARGB();                           //设置画笔的A、R、G、B值</span><br><span class="line">            setAlpha();                          //设置画笔的alpha值</span><br><span class="line">            setTextSize();                       //设置画笔的字体尺寸</span><br><span class="line">            setStyle();                          //设置画笔的风格（空心或者实心）</span><br><span class="line">            setStrokeWidth();                    //设置空心边框的宽度</span><br></pre></td></tr></table></figure>
<p>绘制点：<code>canvas.drawPoint(x,y,paint);</code><br>绘制线：<code>canvas.drawLine(startX,startY,endX,endY,paint);</code><br>绘制多条线：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">float[] pts=&#123;startX1,startY1,endX1,endY1,</span><br><span class="line">                      ......</span><br><span class="line">                     startXn,startYn,endXn,endYn&#125;;</span><br><span class="line">canvas.drawLines(pts,paint);</span><br></pre></td></tr></table></figure></p>
<p>绘制矩形：<code>canvas.drawRect(left,top,right,bottom,paint);</code><br>绘制圆角矩形：<code>canvas.drawRoundRect(left,top,right,bottom,radiusX,radiusY,paint);</code><br>绘制圆形：<code>canvas.drawCircle(circleX,circleY,radius,paint);</code><br>绘制弧、扇形：<code>paint.setStyle(Paint.Style.FILL);
                            canvas.drawArc(left,top,right,bottom,startAngle,sweepAngle,userCenter,paint);            //这个API在版本21以上使用</code><br>  根据paint的Style和useCenter的不同绘制结果也不同：Paint.Style.STROKE时，userCenter为true绘制结果：<br>                 <img src="http://img.blog.csdn.net/20160426132639881" alt="这里写图片描述"><br> userCenter为false绘制结果：<br>                                           <img src="http://img.blog.csdn.net/20160426132657100" alt="这里写图片描述"><br> Paint.Style.FILL时，userCenter为true绘制结果：<br>                    <img src="http://img.blog.csdn.net/20160426132707678" alt="这里写图片描述"><br>userCenter为false绘制结果：<br>                                  <img src="http://img.blog.csdn.net/20160426132715138" alt="这里写图片描述"><br>绘制椭圆：canvas.drawOval(left,top,right,bottom,paint);//根据矩形外接圆绘制椭圆<br>绘制文本：canvas.drawText(text,startX,startY,paint);<br>在指定位置绘制文本：canvas.drawPosText(text,new float[]{X1,Y1,X2,Y2,……XnYn},paint);<br>绘制路径：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Path path = new Path();</span><br><span class="line">            path.moveTo(100, 100);                          </span><br><span class="line">            path.lineTo(200, 300);</span><br><span class="line">            path.lineTo(300, 300);</span><br><span class="line">            path.lineTo(400, 500);</span><br><span class="line">            canvas.drawPath(path,paint);</span><br></pre></td></tr></table></figure></p>
<p>路径：<br><img src="http://img.blog.csdn.net/20160426132819429" alt="这里写图片描述">                 </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/23/字母A-Z的快速定位滑块的学习研究/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="一个写代码的胖子">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/mouse.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个写代码的胖子">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/23/字母A-Z的快速定位滑块的学习研究/" itemprop="url">未命名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-23T21:27:45+08:00">
                2018-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>　　<img src="http://img.blog.csdn.net/20160418130452854" alt="这里写图片描述"><br>　　实习时遇到这么一个需求的更改，把一个带字母快速定位的滑块的listview，将其中的滑块显示全部字母a-z改成listview中数据有哪些，就只显示有数据的字母。在网上搜索了一下这个自定义view的实现，发现和项目中实现的代码基本一致，好吧，原来也是从网上百度到直接复制下来的，汗~<br>　　 结合项目中的代码和网上的资料，我自己学习分析了一下这个自定义sidebar的实现。先贴上源码,源码参考自：<br>　　 <a href="http://blog.csdn.net/woaieillen/article/details/12712137" target="_blank" rel="noopener">http://blog.csdn.net/woaieillen/article/details/12712137</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">public class SideBar extends View &#123;</span><br><span class="line">	// 触摸事件</span><br><span class="line">	private OnTouchingLetterChangedListener onTouchingLetterChangedListener;</span><br><span class="line">	// 26个字母</span><br><span class="line">	public static String[] b = &#123; &quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;, &quot;G&quot;, &quot;H&quot;, &quot;I&quot;,</span><br><span class="line">			&quot;J&quot;, &quot;K&quot;, &quot;L&quot;, &quot;M&quot;, &quot;N&quot;, &quot;O&quot;, &quot;P&quot;, &quot;Q&quot;, &quot;R&quot;, &quot;S&quot;, &quot;T&quot;, &quot;U&quot;, &quot;V&quot;,</span><br><span class="line">			&quot;W&quot;, &quot;X&quot;, &quot;Y&quot;, &quot;Z&quot;, &quot;#&quot; &#125;;</span><br><span class="line">	private int choose = -1;// 选中</span><br><span class="line">	private Paint paint = new Paint();</span><br><span class="line"></span><br><span class="line">	private TextView mTextDialog;</span><br><span class="line"></span><br><span class="line">	public void setTextView(TextView mTextDialog) &#123;</span><br><span class="line">		this.mTextDialog = mTextDialog;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	public SideBar(Context context, AttributeSet attrs, int defStyle) &#123;</span><br><span class="line">		super(context, attrs, defStyle);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public SideBar(Context context, AttributeSet attrs) &#123;</span><br><span class="line">		super(context, attrs);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public SideBar(Context context) &#123;</span><br><span class="line">		super(context);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 重写这个方法</span><br><span class="line">	 */</span><br><span class="line">	protected void onDraw(Canvas canvas) &#123;</span><br><span class="line">		super.onDraw(canvas);</span><br><span class="line">		// 获取焦点改变背景颜色.</span><br><span class="line">		int height = getHeight();// 获取对应高度</span><br><span class="line">		int width = getWidth(); // 获取对应宽度</span><br><span class="line">		int singleHeight = height / b.length;// 获取每一个字母的高度</span><br><span class="line"></span><br><span class="line">		for (int i = 0; i &lt; b.length; i++) &#123;</span><br><span class="line">			paint.setColor(Color.rgb(33, 65, 98));</span><br><span class="line">			// paint.setColor(Color.WHITE);</span><br><span class="line">			paint.setTypeface(Typeface.DEFAULT_BOLD);</span><br><span class="line">			paint.setAntiAlias(true);</span><br><span class="line">			paint.setTextSize(20);</span><br><span class="line">			// 选中的状态</span><br><span class="line">			if (i == choose) &#123;</span><br><span class="line">				paint.setColor(Color.parseColor(&quot;#3399ff&quot;));</span><br><span class="line">				paint.setFakeBoldText(true);</span><br><span class="line">			&#125;</span><br><span class="line">			// x坐标等于中间-字符串宽度的一半.</span><br><span class="line">			float xPos = width / 2 - paint.measureText(b[i]) / 2;</span><br><span class="line">			float yPos = singleHeight * i + singleHeight;</span><br><span class="line">			canvas.drawText(b[i], xPos, yPos, paint);</span><br><span class="line">			paint.reset();// 重置画笔</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@Override</span><br><span class="line">	public boolean dispatchTouchEvent(MotionEvent event) &#123;</span><br><span class="line">		final int action = event.getAction();</span><br><span class="line">		final float y = event.getY();// 点击y坐标</span><br><span class="line">		final int oldChoose = choose;</span><br><span class="line">		final OnTouchingLetterChangedListener listener = onTouchingLetterChangedListener;</span><br><span class="line">		final int c = (int) (y / getHeight() * b.length);// 点击y坐标所占总高度的比例*b数组的长度就等于点击b中的个数.</span><br><span class="line"></span><br><span class="line">		switch (action) &#123;</span><br><span class="line">		case MotionEvent.ACTION_UP:</span><br><span class="line">			setBackgroundDrawable(new ColorDrawable(0x00000000));</span><br><span class="line">			choose = -1;//</span><br><span class="line">			invalidate();</span><br><span class="line">			if (mTextDialog != null) &#123;</span><br><span class="line">				mTextDialog.setVisibility(View.INVISIBLE);</span><br><span class="line">			&#125;</span><br><span class="line">			break;</span><br><span class="line"></span><br><span class="line">		default:</span><br><span class="line">			setBackgroundResource(R.drawable.sidebar_background);</span><br><span class="line">			if (oldChoose != c) &#123;</span><br><span class="line">				if (c &gt;= 0 &amp;&amp; c &lt; b.length) &#123;</span><br><span class="line">					if (listener != null) &#123;</span><br><span class="line">						listener.onTouchingLetterChanged(b[c]);</span><br><span class="line">					&#125;</span><br><span class="line">					if (mTextDialog != null) &#123;</span><br><span class="line">						mTextDialog.setText(b[c]);</span><br><span class="line">						mTextDialog.setVisibility(View.VISIBLE);</span><br><span class="line">					&#125;</span><br><span class="line">					</span><br><span class="line">					choose = c;</span><br><span class="line">					invalidate();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			break;</span><br><span class="line">		&#125;</span><br><span class="line">		return true;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 向外公开的方法</span><br><span class="line">	 * </span><br><span class="line">	 * @param onTouchingLetterChangedListener</span><br><span class="line">	 */</span><br><span class="line">	public void setOnTouchingLetterChangedListener(</span><br><span class="line">			OnTouchingLetterChangedListener onTouchingLetterChangedListener) &#123;</span><br><span class="line">		this.onTouchingLetterChangedListener = onTouchingLetterChangedListener;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 接口</span><br><span class="line">	 * </span><br><span class="line">	 * @author coder</span><br><span class="line">	 * </span><br><span class="line">	 */</span><br><span class="line">	public interface OnTouchingLetterChangedListener &#123;</span><br><span class="line">		public void onTouchingLetterChanged(String s);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>　　很容易看出这个自定义重写了onDraw方法，在方法里绘制了定义好的包含a-z的字母数组。我要完成我的需求，只需要获取到listview里包含的所有item的字母数据，然后做一下去除相同字母的过滤，把得到的字母传给sidebar然后再重新绘制一下就可以了。所以我在其中添加了一个方法setLetters(String[] letters)传入一个String数组，然后将传入的数组赋给绘制的数组，调用invalidate()方法重新绘制就可以了。<br>　　在完成任务之后，我继续研究了下这个自定义的view的具体绘制过程和事件的处理。正好复习下之前看的《Android群英传》里讲的事件传递机制和view绘制过程原理。<br>　　在onDraw()方法里先获取到控件的宽度和高度，然后根据需要绘制的字母个数获得每个字母的高度，初始化画笔paint设置画笔相关参数，计算绘制的x，y坐标的位置，循环字母数组绘制每个字母，如果是处于choose状态，修改画笔颜色并加粗。<br>　　关于事件的处理，在事件拦截方法dispatchTouchEvent中，获取到事件，并根据触摸的位置坐标计算出是哪一个字母位置，在根据事件类型ACTION_UP，触摸离开时，修改view的背景资源为透明，调用invalidate重新绘制，将中间的TextDialog设置为不可见。其他时候修改背景资源，再根据触摸选中的位置设置TextDialog的文字内容和可见，完成监听回调，重新绘制view。<br>    　看都看到这里了就把这个Demo看完吧，到MainActivity.java中，看看这个带特殊的listview是怎么实现的。<br>    　在initView()方法里，首先实例化了一个汉字转化拼音的类对象和一个按照拼音排序的比较器。
    　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//实例化汉字转拼音类</span><br><span class="line">characterParser = CharacterParser.getInstance();</span><br><span class="line">//比较器	</span><br><span class="line">pinyinComparator = new PinyinComparator();</span><br></pre></td></tr></table></figure>
<pre><code>　
</code></pre><p>　　<br>　　然后设置sidebar的触摸监听事件，根据触摸的字母位置快速定位到listview中该字母首次出现的位置。<br>　　<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">//设置右侧触摸监听</span><br><span class="line">		sideBar.setOnTouchingLetterChangedListener(new OnTouchingLetterChangedListener() &#123;</span><br><span class="line">			</span><br><span class="line">			@Override</span><br><span class="line">			public void onTouchingLetterChanged(String s) &#123;</span><br><span class="line">				//该字母首次出现的位置</span><br><span class="line">				int position = adapter.getPositionForSection(s.charAt(0));</span><br><span class="line">				if(position != -1)&#123;</span><br><span class="line">					sortListView.setSelection(position);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br></pre></td></tr></table></figure></p>
<p>　　接下来listview的监听很简单，就是弹出一个吐司，filledData（）方法是从资源文件里读取填充listview的数据，其中用到了characterParser，把数据封装成SortModel对象，存储到一个SourceDateList集合中，并用pinyinComparator进行排序后，初始化了一个SortAdapter，为这个listview设置适配器和数据。最后就是对上方搜索框的设置，初始化mClearEditText后，设置addTextChangedListener监听，根据输入内容调用filterData()方法，过滤数据并更新ListView。
　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">//根据输入框输入值的改变来过滤搜索</span><br><span class="line">		mClearEditText.addTextChangedListener(new TextWatcher() &#123;</span><br><span class="line">			</span><br><span class="line">			@Override</span><br><span class="line">			public void onTextChanged(CharSequence s, int start, int before, int count) &#123;</span><br><span class="line">				//当输入框里面的值为空，更新为原来的列表，否则为过滤数据列表</span><br><span class="line">				filterData(s.toString());</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			@Override</span><br><span class="line">			public void beforeTextChanged(CharSequence s, int start, int count,</span><br><span class="line">					int after) &#123;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			@Override</span><br><span class="line">			public void afterTextChanged(Editable s) &#123;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">private void filterData(String filterStr)&#123;</span><br><span class="line">		List&lt;SortModel&gt; filterDateList = new ArrayList&lt;SortModel&gt;();</span><br><span class="line">		</span><br><span class="line">		if(TextUtils.isEmpty(filterStr))&#123;</span><br><span class="line">			filterDateList = SourceDateList;</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			filterDateList.clear();</span><br><span class="line">			for(SortModel sortModel : SourceDateList)&#123;</span><br><span class="line">				String name = sortModel.getName();</span><br><span class="line">				if(name.indexOf(filterStr.toString()) != -1 || characterParser.getSelling(name).startsWith(filterStr.toString()))&#123;</span><br><span class="line">					filterDateList.add(sortModel);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		// 根据a-z进行排序</span><br><span class="line">		Collections.sort(filterDateList, pinyinComparator);</span><br><span class="line">		adapter.updateListView(filterDateList);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>　　至此看来，想知道listview的实现，就得去看SortAdapter里是怎么设置数据item的了。在getView()方法里对每个item进行设置，调用getSectionForPosition()和getPositionForSection()这两个方法来获取某个字母第一次出现位置来控制tvLetter就是那个显示字母的TextView显示或隐藏。关于getSectionForPosition()和getPositionForSection()这两个方法，是因为SortAdaoter继承了SectionIndexer接口必须实现的，getSectionForPosition（）通过该项的位置，获得所在分类组的索引号，getPositionForSection() 根据分类列的索引号获得该序列的首个位置，这两个方法这里<a href="http://blog.csdn.net/jack_l1/article/details/14165291" target="_blank" rel="noopener">http://blog.csdn.net/jack_l1/article/details/14165291</a>写的很清楚了，一看就懂。
　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">	 * 根据ListView的当前位置获取分类的首字母的Char ascii值</span><br><span class="line">	 */</span><br><span class="line">	public int getSectionForPosition(int position) &#123;</span><br><span class="line">		return list.get(position).getSortLetters().charAt(0);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	/**</span><br><span class="line">	 * 根据分类的首字母的Char ascii值获取其第一次出现该首字母的位置</span><br><span class="line">	 */</span><br><span class="line">	public int getPositionForSection(int section) &#123;</span><br><span class="line">		for (int i = 0; i &lt; getCount(); i++) &#123;</span><br><span class="line">			String sortStr = list.get(i).getSortLetters();</span><br><span class="line">			char firstChar = sortStr.toUpperCase().charAt(0);</span><br><span class="line">			if (firstChar == section) &#123;</span><br><span class="line">				return i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		return -1;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>　　知道这两个方法后，再看getView里的代码就很清晰了，每次先获取当前位置的selection值，根据selection值获取这个值第一次出现的位置，如果和当前位置一样就显示tvLetter可见并设置tvLetter上的字母，如果不是第一次就把tvLetter隐藏。
　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public View getView(final int position, View view, ViewGroup arg2) &#123;</span><br><span class="line">		ViewHolder viewHolder = null;</span><br><span class="line">		final SortModel mContent = list.get(position);</span><br><span class="line">		if (view == null) &#123;</span><br><span class="line">			viewHolder = new ViewHolder();</span><br><span class="line">			view = LayoutInflater.from(mContext).inflate(R.layout.item, null);</span><br><span class="line">			viewHolder.tvTitle = (TextView) view.findViewById(R.id.title);</span><br><span class="line">			viewHolder.tvLetter = (TextView) view.findViewById(R.id.catalog);</span><br><span class="line">			view.setTag(viewHolder);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			viewHolder = (ViewHolder) view.getTag();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		//根据position获取分类的首字母的Char ascii值</span><br><span class="line">		int section = getSectionForPosition(position);</span><br><span class="line">		</span><br><span class="line">		//如果当前位置等于该分类首字母的Char的位置 ，则认为是第一次出现</span><br><span class="line">		if(position == getPositionForSection(section))&#123;</span><br><span class="line">			viewHolder.tvLetter.setVisibility(View.VISIBLE);</span><br><span class="line">			viewHolder.tvLetter.setText(mContent.getSortLetters());</span><br><span class="line">		&#125;else&#123;</span><br><span class="line">			viewHolder.tvLetter.setVisibility(View.GONE);</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">		viewHolder.tvTitle.setText(this.list.get(position).getName());</span><br><span class="line">		</span><br><span class="line">		return view;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	final static class ViewHolder &#123;</span><br><span class="line">		TextView tvLetter;</span><br><span class="line">		TextView tvTitle;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>　　</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/mouse.png"
                alt="一个写代码的胖子" />
            
              <p class="site-author-name" itemprop="name">一个写代码的胖子</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">一个写代码的胖子</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
